<configuration>

	<define name="GENERAL_PROPS_EXISTS"
		class="com.daimler.cebas.system.control.validation.FileOnClasspath">
		<path>zenzefi-general.properties</path>
	</define>

	<property name="N_A" value="-" />
	<property name="CONSOLE_LOG_PATTERN"
		value="%clr(%d{MM-dd HH:mm:ss.SSS}){faint} %clr(%5p) %clr(${PID:- }){magenta} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(%X{userId:-${N_A}}){blue} %clr(%X{logId:-${N_A}}){cyan} %clr(:){faint} %m%n%wEx" />
	<property resource="zenzefi.properties" />

	<if condition='property("GENERAL_PROPS_EXISTS").equals("true")'>
		<then>
			<property resource="zenzefi-general.properties" />
		</then>
	</if>

	<include
		resource="org/springframework/boot/logging/logback/base.xml" />
		
	<appender name="ROLLING"
		class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${SERVER_LOGBACK_FILE}</file>
		<rollingPolicy
			class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
			<!-- rollover daily -->
			<fileNamePattern>${SERVER_LOGBACK_FILENAME_PATTERN}</fileNamePattern>
			<!-- each file should be at most 30MB(so that there are not too many small 
				log files), keep 60 days worth of history, but at most 2GB -->
			<maxFileSize>30MB</maxFileSize>
			<maxHistory>60</maxHistory>
			<totalSizeCap>300MB</totalSizeCap>
		</rollingPolicy>
		<encoder>
			<pattern>%d{"yyyy-MM-dd HH:mm:ss,SSSZ"} [%thread] %level %logger{35} %X{userId:-${N_A}} %X{logId:-${N_A}} %msg%n</pattern>
		</encoder>
	</appender>

	<logger name="org.springframework" level="INFO" />
	<logger name="org.hibernate" level="INFO" />
	<logger name="com.daimler.cebas" level="INFO" />
	
	<!-- Enable to have Rest messages logged -->
	<!-- logger name="org.springframework.web.client.RestTemplate" level="DEBUG" /-->
	
	<!-- should be removed when the bug, parsing default value to Integer, from Swagger will be fixed: https://github.com/springfox/springfox/issues/1100 -->
	<logger name="io.swagger.models.parameters.AbstractSerializableParameter" level="ERROR" />


	<root level="INFO">
		<appender-ref ref="CONSOLE" />
		<appender-ref ref="ROLLING" />
	</root>

</configuration>
